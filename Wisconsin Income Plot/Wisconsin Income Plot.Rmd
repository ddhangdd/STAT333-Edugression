---
title: "Wisconsin Income Plot"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
```

## Authors

**TODO**: Write Down Authors' Full Name and Email Address


## Introduction

**TODO**: Write down brief explanation what we are trying to plot, why it is useful, reason why we are narrowing down to the Wisconsin's Data. Include our topic.


## Data

```{r loadData}

library(tidyverse) ## To clean up data much easier

# Read CSV data
All_Income <- read.csv("2017_All_County_QCEW_AnnualAverage_Total.csv")
head(All_Income)

```

**TODO**: What does this data for? How it looks like? Include the meaning of each column, we need to seelct some.


## Select Wisconsin's Data

```{r selectWisconsin}

## Retrieve Index of row containing Wisconsin's data
WI_Index <- which(substr(All_Income$area_fips, 1, 2) == "55")
## Filter Wisconsin's Data
WI_Income <- All_Income[WI_Index, ]

## Clean useless data and values
rm(WI_Index, All_Income)

```

First two digit of FIPS code indicates each state
**TODO**: Some description
Reference: https://www.nrcs.usda.gov/wps/portal/nrcs/detail/?cid=nrcs143_013696


## Select Data for Plotting

```{r selectDataForPlotting}

# Filtering Rows in order to see the total incomes of each counties of Wisconsin
WI_Total_Income_Index <- which(WI_Income$own_code == 0)
WI_Total_Income <- WI_Income[WI_Total_Income_Index, ]
# Clearing useless data
rm(WI_Income, WI_Total_Income_Index)

# Remove 2 extra rows in the WI_Total_Income
# Wisconsin has 72 counties, but it contains 74 rows
notCountyFIPS <- which(WI_Total_Income$area_fips == "55000" | ## For WI cummulated
                         WI_Total_Income$area_fips == "55999" ## For WI Unknowns
                       )
WI_Total_Income <- WI_Total_Income[-notCountyFIPS, ]
# Clearing useless data
rm(notCountyFIPS)


# Filter meaningful columns
WI_Total_Income <- as_tibble(
  list(
    countyFIPS = as.numeric(as.character(WI_Total_Income$area_fips)), ## FIPS code to indicate each county
    annualAvgQuarterlyEstablishments = WI_Total_Income$annual_avg_estabs,
    annualAvgEmployments = WI_Total_Income$annual_avg_emplvl,
    totalAnnualWage = WI_Total_Income$total_annual_wages, ## Total wages (Income)
    ## Taxable income and contribution will follow the tendency of total annual wages
    averageWeeklyWage = WI_Total_Income$annual_avg_wkly_wage,
    annualWagesPerEmployee = WI_Total_Income$avg_annual_pay
  )
)



```

**TODO** Write down some description what and why we are doing here.
Reference: https://data.bls.gov/cew/doc/titles/ownership/ownership_titles.htm
Reference: https://en.wikipedia.org/wiki/List_of_counties_in_Wisconsin
Reference: http://www.dlt.ri.gov/lmi/faq/employment.htm


## Making Plot

```{r plot, fig.height = 20, fig.asp = 1, fig.align = "center"}

library(choroplethr)

## Plotting for totalAnnualWage of each county
### Need to make separated dataframe
### region = countyFIPS
### value = totalAnnualWage
df <- as_tibble(
  list(
    region = WI_Total_Income$countyFIPS,
    value = WI_Total_Income$totalAnnualWage
  )
)
county_choropleth(df, state_zoom="wisconsin",
                  title = "2017 Total Annual Wage of counties in the Wisconsin",
                  legend = "Total Annual Wage (USD)",
                  num_colors = 1)

## Plotting for annualAveragePerEmployee of each county
### Need to make separated dataframe
### region = countyFIPS
### value = annualAveragePerEmployee
df <- as_tibble(
  list(
    region = WI_Total_Income$countyFIPS,
    value = WI_Total_Income$annualWagesPerEmployee
  )
)
county_choropleth(df, state_zoom="wisconsin",
                  title = "2017 Annual Wage per Employee of counties in the Wisconsin",
                  legend = "Annual Wages Per Employee (USD)",
                  num_colors = 1)

## clearing useless data
rm(df)

```

**TODO**: Write down some description what we are trying to show


## Discussion Topics/Questions

**TODO**: Make some questions that we might need to get answers from in-class discussion
